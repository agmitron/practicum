# 18.03.2021. Основы Webpack

## Перед вебинаром
1. Установленная Node.js (если вы на Windows или MacOS - достаточно просто скачать установщик)
2. (если вы на Linux) - возможно, дополнительно потребуется установить **npm**. Рекомендую устанавливать на Linux по этой инструкции: https://github.com/nodesource/distributions#installation-instructions
3. Проинициализируйте Node.js проект, написав следующую команду: 

```
    npm init -y
```
4. Если у вас появился файл package.json, то вы справились с задачей.

## Что такое сборка проекта и зачем она нужна? 
Вы уже знаете, что такое *модули* в программировании. Я буду иметь в виду под этим "кусочки" проекта, который мы разделяем для удобства его поддержки - чтобы не писать весь код в одном файле и переиспользовать наш функционал там, где это возможно.

Во фронтенде остро стоит проблема загрузки файлов с сервера, и она касается всех типов файлов: медиа, стили, скрипты и другие. Каждый лишний килобайт на счету - ведь сегодня большинство пользователей посещают сайты со смартфонов, и там интернет-трафик имеет значение. 

Поэтому нужно всеми силами облегчить эту задачу для браузеров наших посетителей.

На данный момент в наших проектах много .js и .css файлов, разбитых по модулям и расфасованным по папочкам, чтобы в них было легко ориентироваться. Они импортируют друг друга через директивы `import` в JS и `@import` в CSS. Каждый такой импорт - хоть и незначительная, но допольнительная загрузка с сервера, на котором расположен наш сайт.

**Мы можем оптимизировать этот момент.**
> Как? 
> Спихнув всё в один файл. 
> Но мы ведь так долго учили БЭМ и Nested, чтобы избежать этого!

Да. Nested и БЭМ - отличные инструменты для разработчиков во время разработки. Но конечному пользователю на это всё равно, и для него важнее, за сколько загрузится сайт и сколько трафика это истратит для него. 

К счастью, подобную оптимизацию за нас может сделать **сборщик проекта**.

## Введение в Webpack
Webpack - один из таких сборщиков. У него есть альтернативы, например: 
- Parcel
- Rollup
- Grunt

И прочие. Webpack самый популярный, на нём работает подавляющее большинство современных фреймворков. Да и после его освоения будет несложно освоить альтернативы.

Ссылка на документацию Webpack: [https://webpack.js.org/](https://webpack.js.org/)

**Установка:**
```bash
    npm install --save-dev webpack 
    npm install --save-dev webpack-cli # Этот пакет нужен для взаимодействия через командную строку
```

Мы установили нашу первую зависимость для разработки, указав флаг --save-dev. Поскольку мы будем собирать наш проект перед тем, как выпустим его в продакшен, и дальше нам не понадобится эта зависимость, для нас это подойдёт.

**Когда писать --save-dev, а когда нет?**
Когда от библиотеки зависит работоспособность вашего проекта в продакшене (при использовании конечным пользователем) - это обычная зависимость, указывать флаг `--save-dev` *не нужно.*

Если вы понимаете, что устанавливаете какую-то утилиту, нужную вам **только** во время разработки, то указывайте этот флаг. 

**Скрипт для запуска**
Откройте файл package.json. Найдите поле "scripts". Отредактируйте так, чтобы оно выглядело следующим образом: 

```json
"scripts": {
  "build": "webpack --config webpack.config.js"
}
```

Теперь откройте командную строку, перейдите в директорию проекта и попробуйте написать `npm run build`. Посмотрите, что получилось.

Если у вас произошла ошибка - всё в порядке. По умолчанию Webpack ищет директорию src и файл index.js внутри неё - это главный файл, куда будет импортировано всё из нашего проекта (вообще всё - и стили, и картинки, и скрипты). 

Создайте в вашем проекте папку src и файл index.js внутри неё. Должно получиться вот так: 

- project
    - package.json
    - package-lock.json
    - node_modules
    - src 
        - index.js

После этого ещё раз запустите сборку и на этот раз должно всё получиться. У вас появится новая папка в корне проекта с именем dist. Это уже собранный проект. Изучите файл внутри неё. 
Если ваш index.js был пустым, то и dist/main.js тоже окажется пустым. 